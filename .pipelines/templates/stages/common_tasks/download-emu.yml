parameters:
  - name: tridentSourceDirectory
    type: string
    default: "$(Build.SourcesDirectory)"

steps:
  - script: |
      set -eu
      echo "##vso[task.setvariable variable=emu_package_name]$(make print-var-emu-package-name)"
      echo "##vso[task.setvariable variable=emu_package_version]$(make print-var-emu-package-version)"
    displayName: "Extract and Set EMU Package Variables"

  - task: UniversalPackages@0
    displayName: "Download EMU"
    retryCountOnTaskFailure: 3
    inputs:
      command: "download"
      downloadDirectory: "./artifacts"
      vstsFeed: "mariner/MarinerCoreArtifacts"
      vstsFeedPackage: "$(emu_package_name)"
      vstsPackageVersion: "$(emu_package_version)"
