parameters:
  - name: osmodifierBuildType
    displayName: OSModifier build type
    type: string
    values:
      - main
      - preview

  - name: osModifierVersion
    displayName: OSModifier version
    type: string
    default: ""

steps:
  - ${{ if and(eq(parameters.osmodifierBuildType, 'main'), ne(parameters.osModifierVersion, '')) }}:
    - task: UniversalPackages@0
      displayName: "Download OSModifier (main - exact version)"
      inputs:
        command: download
        vstsFeed: polar/PolarCoreArtifacts
        vstsFeedPackage: osmodifier
        vstsPackageVersion: ${{ parameters.osModifierVersion }}
        downloadDirectory: "$(Build.SourcesDirectory)/artifacts"

  - ${{ if and(eq(parameters.osmodifierBuildType, 'main'), eq(parameters.osModifierVersion, '')) }}:
    - task: UniversalPackages@0
      displayName: "Download OSModifier (main - latest)"
      inputs:
        command: download
        vstsFeed: polar/PolarCoreArtifacts
        vstsFeedPackage: osmodifier
        vstsPackageVersion: '*'
        downloadDirectory: "$(Build.SourcesDirectory)/artifacts"

  - ${{ if and(eq(parameters.osmodifierBuildType, 'preview'), ne(parameters.osModifierVersion, '')) }}:
    - task: UniversalPackages@0
      displayName: "Download OSModifier (preview - exact version)"
      inputs:
        command: download
        vstsFeed: polar/PolarCoreArtifacts
        vstsFeedPackage: osmodifier_preview
        vstsPackageVersion: ${{ parameters.osModifierVersion }}
        downloadDirectory: "$(Build.SourcesDirectory)/artifacts"

  - ${{ if and(eq(parameters.osmodifierBuildType, 'preview'), eq(parameters.osModifierVersion, '')) }}:
    - task: UniversalPackages@0
      displayName: "Download OSModifier (preview - latest)"
      inputs:
        command: download
        vstsFeed: polar/PolarCoreArtifacts
        vstsFeedPackage: osmodifier_preview
        vstsPackageVersion: '*'
        downloadDirectory: "$(Build.SourcesDirectory)/artifacts"
