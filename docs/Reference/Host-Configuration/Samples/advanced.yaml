# THIS FILE IS AUTOMATICALLY GENERATED BY `docbuilder/src/host_config.rs::print_sample("advanced")`.
# DO NOT EDIT MANUALLY!

trident:
  disable: false
  selfUpgrade: false
  phonehome: null
storage:
  disks:
  - id: disk1
    device: /dev/disk/by-path/pci-0000:00:1f.2-ata-1
    partitionTableType: gpt
    partitions:
    - id: esp1
      type: esp
      size: 64M
    - id: boot-a1
      type: xbootldr
      size: 512M
    - id: boot-b1
      type: xbootldr
      size: 512M
    - id: root-a1
      type: root
      size: 4G
    - id: root-b1
      type: root
      size: 4G
    - id: root-hash-a1
      type: root-verity
      size: 400M
    - id: root-hash-b1
      type: root-verity
      size: 400M
    - id: swap1
      type: swap
      size: 2G
    - id: trident1
      type: linux-generic
      size: 128M
    - id: trident-overlay-a1
      type: linux-generic
      size: 128M
    - id: trident-overlay-b1
      type: linux-generic
      size: 128M
    - id: enc-srv1
      type: linux-generic
      size: 1G
    adoptedPartitions:
    - id: bootstrap
      size: null
      uuid: a0a0a0a0-a0a0-a0a0-a0a0-a0a0a0a0a0a0
  - id: disk2
    device: /dev/disk/by-path/pci-0000:00:1f.2-ata-2
    partitionTableType: gpt
    partitions:
    - id: esp2
      type: esp
      size: 64M
    - id: boot-a2
      type: xbootldr
      size: 512M
    - id: boot-b2
      type: xbootldr
      size: 512M
    - id: root-a2
      type: root
      size: 4G
    - id: root-b2
      type: root
      size: 4G
    - id: root-hash-a2
      type: root-verity
      size: 400M
    - id: root-hash-b2
      type: root-verity
      size: 400M
    - id: swap2
      type: swap
      size: 2G
    - id: trident2
      type: linux-generic
      size: 128M
    - id: trident-overlay-a2
      type: linux-generic
      size: 128M
    - id: trident-overlay-b2
      type: linux-generic
      size: 128M
    - id: enc-srv2
      type: linux-generic
      size: 1G
  encryption:
    recoveryKeyUrl: file:///recovery.key
    volumes:
    - id: srv
      deviceName: luks-srv
      targetId: enc-srv
  raid:
    software:
    - id: boot-a
      name: boot-a
      level: raid1
      devices:
      - boot-a1
      - boot-a2
      metadataVersion: '1.0'
    - id: boot-b
      name: boot-b
      level: raid1
      devices:
      - boot-b1
      - boot-b2
      metadataVersion: '1.0'
    - id: root-a
      name: root-a
      level: raid1
      devices:
      - root-a1
      - root-a2
      metadataVersion: '1.0'
    - id: root-b
      name: root-b
      level: raid1
      devices:
      - root-b1
      - root-b2
      metadataVersion: '1.0'
    - id: root-hash-a
      name: root-hash-a
      level: raid1
      devices:
      - root-hash-a1
      - root-hash-a2
      metadataVersion: '1.0'
    - id: root-hash-b
      name: root-hash-b
      level: raid1
      devices:
      - root-hash-b1
      - root-hash-b2
      metadataVersion: '1.0'
    - id: trident
      name: trident
      level: raid1
      devices:
      - trident1
      - trident2
      metadataVersion: '1.0'
    - id: trident-overlay-a
      name: trident-overlay-a
      level: raid1
      devices:
      - trident-overlay-a1
      - trident-overlay-a2
      metadataVersion: '1.0'
    - id: trident-overlay-b
      name: trident-overlay-b
      level: raid1
      devices:
      - trident-overlay-b1
      - trident-overlay-b2
      metadataVersion: '1.0'
    - id: enc-srv
      name: enc-srv
      level: raid1
      devices:
      - enc-srv1
      - enc-srv2
      metadataVersion: '1.0'
  verity:
  - id: root-verity
    deviceName: root
    dataTargetId: root
    hashTargetId: root-hash
  mountPoints:
  - path: /boot/efi
    filesystem: vfat
    options:
    - umask=0077
    targetId: esp1
  - path: /boot
    filesystem: ext4
    options:
    - defaults
    targetId: boot
  - path: /
    filesystem: ext4
    options:
    - defaults
    - ro
    targetId: root-verity
  - path: /var/lib/trident
    filesystem: ext4
    options:
    - defaults
    targetId: trident
  - path: /var/lib/trident-overlay
    filesystem: ext4
    options:
    - defaults
    targetId: trident-overlay
  - path: none
    filesystem: swap
    options:
    - sw
    targetId: swap1
  - path: none
    filesystem: swap
    options:
    - sw
    targetId: swap2
  - path: /srv
    filesystem: ext4
    options:
    - defaults
    targetId: srv
  abUpdate:
    volumePairs:
    - id: boot
      volumeAId: boot-a
      volumeBId: boot-b
    - id: root
      volumeAId: root-a
      volumeBId: root-b
    - id: root-hash
      volumeAId: root-hash-a
      volumeBId: root-hash-b
    - id: trident-overlay
      volumeAId: trident-overlay-a
      volumeBId: trident-overlay-b
  images:
  - url: file:///trident_cdrom/data/esp.rawzst
    sha256: e15853875ce26f8fb8090177821240a889e21ac0c5acee75c5a060401bbdf0ae
    format: raw-zst
    targetId: esp1
  - url: file:///trident_cdrom/data/esp.rawzst
    sha256: e15853875ce26f8fb8090177821240a889e21ac0c5acee75c5a060401bbdf0ae
    format: raw-zst
    targetId: esp2
  - url: file:///trident_cdrom/data/boot.rawzst
    sha256: b8170f4c46eab33f641e7e102a573d7ef6d8b27dc912b5ecfb033e82f1fff52a
    format: raw-zst
    targetId: boot
  - url: file:///trident_cdrom/data/root.rawzst
    sha256: c2ce64662fbe2fa0b30a878c11aac71cb9f1ef27f59a157362ccc0881df47293
    format: raw-zst
    targetId: root
  - url: file:///trident_cdrom/data/roothash.rawzst
    sha256: e875214b5ba8aac92203b72dbf0f78d673a16bd3c2a6f3577bcf4ed5d7c903af
    format: raw-zst
    targetId: root-hash
scripts:
  postProvision:
  - name: sample-provision-script
    servicingType:
    - clean-install
    - ab-update
    content: echo 'Post provision!'
    logFilePath: /var/log/sample-provision-script.log
  postConfigure:
  - name: sample-configure-script
    servicingType:
    - all
    content: /var/config-script.sh
    logFilePath: /var/log/sample-configure-script.log
    environmentVariables:
      SAMPLE_VARIABLE: sample-variable-value
os:
  network:
    version: 2
    ethernets:
      eths:
        match:
          name: enp*
        dhcp4: true
  users:
  - name: my-custom-user
    sshPublicKeys:
    - <MY_PUBLIC_SSH_KEY>
    sshMode: key-only
  additionalFiles:
  - destination: /var/config-script.sh
    content: echo 'Hello, world!'
  - destination: /var/lib/cloud/instance/user-data
    content: '#cloud-config'
