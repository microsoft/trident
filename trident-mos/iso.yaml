os:
  hostname: trident-mos-testimage

  packages:
    update:
      - systemd

    install:
      - curl
      - device-mapper
      - dnf
      - dosfstools
      - efibootmgr
      - iproute
      - iptables
      - lsof
      - mdadm
      - netplan
      # Support for mounting NTFS filesystems
      - ntfs-3g
      # Support for creating NTFS filesystems
      - ntfsprogs
      - openssh-server
      - squashfs-tools
      - tar
      - tpm2-tools
      - veritysetup
      - vim

  additionalFiles:
    files/getty@.service:
    - path: /usr/lib/systemd/system/getty@.service
    files/serial-getty@.service:
    - path: /usr/lib/systemd/system/serial-getty@.service
    files/root.profile:
    - path: /root/.profile
    files/download-trident.service:
    - path: /usr/lib/systemd/system/download-trident.service

  services:
    enable:
    - download-trident

scripts:
  postCustomization:
    - path: post-install.sh

iso:
  additionalFiles:
    files/config-placeholder.yaml:
      - path: /trident-config.yaml
  kernelCommandLine:
    extraCommandLine: "console=tty0 console=ttyS0 rd.luks=0"
