storage:
  bootType: efi

  disks:
    - partitionTableType: gpt
      maxSize: 4G
      partitions:
        - id: esp
          type: esp
          start: 1M
          end: 9M

        - id: rootfs
          start: 9M
  fileSystems:
    - deviceId: esp
      type: fat32
      mountPoint:
        path: /boot/efi
        options: umask=0077

    - deviceId: rootfs
      type: ext4
      mountPoint:
        path: /

os:
  resetBootLoaderType: hard-reset
  hostname: trident-containerhost-mos-testimage

  packages:
    install:
      - curl
      - device-mapper
      - dnf
      - moby-engine
      - moby-cli
      - openssh-server
      - squashfs-tools
      - tar
      - vim

  additionalFiles:
    files/getty@.service:
      - path: /usr/lib/systemd/system/getty@.service
    files/serial-getty@.service:
      - path: /usr/lib/systemd/system/serial-getty@.service
    files/root.profile:
      - path: /root/.profile
    files/download-trident-container.service:
      - path: /usr/lib/systemd/system/download-trident-container.service

  services:
    enable:
      - download-trident-container

scripts:
  postCustomization:
    - path: post-install.sh

iso:
  additionalFiles:
    files/config-placeholder.yaml:
      - path: /trident-config.yaml
    files/pre-trident-script.sh:
      - path: /pre-trident-script.sh
  kernelCommandLine:
    extraCommandLine: "console=tty0 console=ttyS0 rd.luks=0"
